# XML

- XML (Ngôn ngữ đánh dấu mở rộng) là ngôn ngữ đánh dấu bắt nguồn từ SGML (Ngôn ngữ đánh dấu tổng quát chuẩn), đây là chuẩn mà HTML dựa trên. XML thường được các ứng dụng sử dụng để lưu trữ và vận chuyển dữ liệu theo định dạng mà con người có thể đọc được và máy có thể phân tích được. Đây là định dạng linh hoạt và được sử dụng rộng rãi để trao đổi dữ liệu giữa các hệ thống và ứng dụng khác nhau. XML bao gồm các elements, attributes, and character data được sử dụng để biểu diễn dữ liệu theo cách có cấu trúc và có tổ chức.

## Cấu trúc và cú pháp XML

- Các phần tử XML được biểu diễn bằng các thẻ, được bao quanh bởi dấu ngoặc nhọn (<>). Các thẻ thường đi theo cặp, với thẻ mở trước nội dung và thẻ đóng sau nội dung. Ví dụ:

![image](https://github.com/user-attachments/assets/5d91cb1a-c605-4e54-aa24-af23fa0cbf97)

- XML được sử dụng rộng rãi trong các ứng dụng web để trao đổi dữ liệu, lưu trữ và cấu hình. Nó thường được sử dụng cho các dịch vụ web và API, chẳng hạn như SOAP và REST , để trao đổi dữ liệu giữa các hệ thống. XML cũng được sử dụng cho các tệp cấu hình, chẳng hạn như cấu hình máy chủ web hoặc cài đặt ứng dụng.

- **XSLT** (Extensible Stylesheet Language Transformations) là ngôn ngữ được sử dụng để chuyển đổi và định dạng tài liệu XML . Trong khi XSLT chủ yếu được sử dụng để chuyển đổi và định dạng dữ liệu, nó cũng có liên quan đáng kể đến các cuộc tấn công XXE ( XML External Entities).

- XSLT có thể được sử dụng để tạo điều kiện cho các cuộc tấn công XXE theo một số cách:

  - Trích xuất dữ liệu : XSLT có thể được sử dụng để trích xuất dữ liệu nhạy cảm từ một tài liệu XML , sau đó có thể được sử dụng trong một cuộc tấn công XXE . Ví dụ, một bảng định kiểu XSLT có thể trích xuất thông tin xác thực của người dùng hoặc thông tin nhạy cảm khác từ một tệp XML .

  - Mở rộng thực thể : XSLT có thể mở rộng các thực thể được xác định trong tài liệu XML , bao gồm các thực thể bên ngoài. Điều này có thể cho phép kẻ tấn công đưa các thực thể độc hại, dẫn đến lỗ hổng XXE .
 
  - Thao tác dữ liệu : XSLT có thể thao tác dữ liệu trong tài liệu XML , có khả năng cho phép kẻ tấn công đưa dữ liệu độc hại hoặc sửa đổi dữ liệu hiện có để khai thác lỗ hổng XXE .

  - Blind XXE : XSLT có thể được sử dụng để thực hiện các cuộc tấn công blind XXE , trong đó kẻ tấn công sẽ đưa các thực thể độc hại vào mà không thấy phản hồi của máy chủ.

- DTDs or Document Type Definitions xác định cấu trúc và ràng buộc của một tài liệu XML . Chúng chỉ định các thành phần, thuộc tính và mối quan hệ được phép giữa chúng. DTD có thể nằm bên trong tài liệu XML hoặc nằm bên ngoài trong một tệp riêng biệt.

  - Xác thực : DTD xác thực cấu trúc của XML để đảm bảo nó đáp ứng các tiêu chí cụ thể trước khi xử lý, điều này rất quan trọng trong môi trường mà tính toàn vẹn của dữ liệu là yếu tố then chốt.
 
  - Khai báo thực thể : DTD định nghĩa các thực thể có thể được sử dụng trong toàn bộ tài liệu XML , bao gồm các thực thể bên ngoài đóng vai trò quan trọng trong các cuộc tấn công XXE .
 
![image](https://github.com/user-attachments/assets/3a3acb0e-23f9-4d9c-9ee3-c705d9d2f7c5)


## In-band XXE

- Challenge:

![image](https://github.com/user-attachments/assets/92e9b579-8b15-48b3-b024-989f246905dc)

![image](https://github.com/user-attachments/assets/373d3e5d-0098-4521-854f-bcc22b3bc762)

- flag: `THM{1N_b4Nd_1$_34sYY}`


## SSRF + XXE

![image](https://github.com/user-attachments/assets/046fe470-ce13-4f0f-9c15-e1d8a00c3019)

![image](https://github.com/user-attachments/assets/fef40a17-e155-421a-8088-1d764bfaacfe)

- flag: `THM{0O8_xx3!!}`

- port: `81`

