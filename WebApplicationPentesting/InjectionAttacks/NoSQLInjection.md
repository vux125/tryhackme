- NoSQL yêu cầu các mảng liên kết lồng nhau => để chèn NoSQL cần phải chèn các mảng vào ứng dụng.

- Tiêm cú pháp - Tương tự như tiêm SQL , trong đó chúng ta có khả năng thoát khỏi truy vấn và tiêm tải trọng của riêng mình. Sự khác biệt chính với tiêm SQL là cú pháp được sử dụng để thực hiện tấn công tiêm.

- Tiêm toán tử — Ngay cả khi chúng ta không thể thoát khỏi truy vấn, chúng ta vẫn có thể tiêm toán tử truy vấn NoSQL để điều khiển hành vi của truy vấn, cho phép chúng ta dàn dựng các cuộc tấn công như bỏ qua xác thực.

- Challenge 1:

  - Giao diện:
  
![image](https://github.com/user-attachments/assets/de3235ff-fe13-42b0-aaae-eb34e624e6ce)

  - Đăng nhập tài khoản bất kỳ và bắt bằng burp suite:

![image](https://github.com/user-attachments/assets/cc62680c-5fe8-42ac-9960-cee8a4bbe79d)

  - Lấy PHPSESSID thay vào cookie và truy cập file /sekr3tPl4ce.php
![image](https://github.com/user-attachments/assets/0c9ffc22-6c5f-4970-a856-6e5166648579)

  - Thông tin admin hiện ra:
    
![image](https://github.com/user-attachments/assets/9f1f6869-015b-48e3-bd4e-b20ce93caaa3)

  - Result: admin@nosql.int

- Challenge 2:

  - Người dùng đầu không phải admin:

![image](https://github.com/user-attachments/assets/332eab18-2adb-4efe-9137-878e7760a348)

![image](https://github.com/user-attachments/assets/d1709675-6050-445b-bbae-484913c037da)

  - Người dùng không phải admin và pedro:

![image](https://github.com/user-attachments/assets/23bdc43e-32ed-4ef1-a7db-97548134bdf7)

![image](https://github.com/user-attachments/assets/b2ce3eae-0a4a-45ca-99b9-3c16429abd1b)

  - Người dùng không phải admin pedro và john:

![image](https://github.com/user-attachments/assets/cfbea698-dafb-4d06-9f56-0db361f8ab53)

![image](https://github.com/user-attachments/assets/8131f393-8d8d-4d35-9d33-e44dc10fe402)

  - Người dùng không phải admin pedro john và secret:

![image](https://github.com/user-attachments/assets/302dbd5a-abdd-4c16-b5fa-8da6fb94af71)

  - Như vậy không còn người dùng nào nữa => có 4 người dùng

## Trích xuất mật khẩu người dùng

- Chúng ta sẽ lạm dụng toán tử $regex để hỏi một loạt các câu hỏi cho máy chủ cho phép chúng ta khôi phục mật khẩu thông qua một quy trình giống như chơi trò chơi treo cổ.

- Chèn: `user=john&pass[$regex]=^.{9}$` => pass có độ dài là 9 ký tự không

![image](https://github.com/user-attachments/assets/11ac1591-5ab8-4fc0-9670-a5959559a946)

- Chèn: `user=john&pass[$regex]=^.{8}$` => pass có độ dài là 8 ký tự không

![image](https://github.com/user-attachments/assets/2cee5d32-309c-4cfa-8963-29feb79fc7a6)

==> mật khẩu có 8 ký tự

- Sử dụng intruder để tìm mật khẩu:

![image](https://github.com/user-attachments/assets/03650df2-0331-4fad-9c4e-67205a0ff3c8)

![image](https://github.com/user-attachments/assets/662abb6d-f96e-4a3d-8bde-7f3418db5f07)

- Sử dụng intruder để tìm mật khẩu cảu những người dùng còn lại

- Dùng nmap quét tìm các dịch vụ được dùng trên máy chủ:

![image](https://github.com/user-attachments/assets/7f667171-4b4b-4095-90de-6fc2cfd12041)

- Dùng burp suite để dò mật khẩu:

![image](https://github.com/user-attachments/assets/ebb358d4-e616-432b-8e3e-3db3a7bad5fc)

![image](https://github.com/user-attachments/assets/8854ab5a-8f7f-4b1d-bdcb-57afff589eba)

- flag: `flag{N0Sql_n01iF3!}`
