# Enumeration & Brute Force

- Authentication Enumeration là một khía cạnh cơ bản của thử nghiệm bảo mật, tập trung cụ thể vào các cơ chế bảo vệ các khía cạnh nhạy cảm của ứng dụng web; quy trình này bao gồm việc kiểm tra có phương pháp các thành phần xác thực khác nhau, từ xác thực tên người dùng đến chính sách mật khẩu và quản lý phiên. Mỗi thành phần này đều được kiểm tra tỉ mỉ vì chúng đại diện cho các lỗ hổng tiềm ẩn, nếu bị khai thác, có thể dẫn đến vi phạm bảo mật đáng kể.

## Authentication Enumeration 

- Identifying Valid Usernames: Password Policies

- Password Policies: Các hướng dẫn khi tạo mật khẩu có thể cung cấp những hiểu biết có giá trị về độ phức tạp của mật khẩu được sử dụng trong ứng dụng. Bằng cách hiểu các chính sách này, kẻ tấn công có thể đánh giá được độ phức tạp tiềm ẩn của mật khẩu và điều chỉnh chiến lược của chúng cho phù hợp. 

***Nững nơi phổ biến để liệt kê***

- Registration Pages

- Password Reset Features

- Verbose Errors

- Data Breach Information

## Enumerating Users via Verbose Errors

- Việc thông báo lỗi quá chi tiết sẽ tiềm ẩn nhiều nguy cơ nguy hiểm, cung cấp nhiều thông tin hưu ích cho quá trình khai thác của kẻ tấn công.

- Ví dụ nếu chúng ta nhập thông tin đăng nhập không tồn tại trên hệ thống vào form login như sau, nó trả về thông báo lỗi ***Email does not exits***:

![image](https://github.com/user-attachments/assets/801a0684-4c1e-4975-80e9-6211791b3140)

- Chúng ta sử dụng đoạn code python sau để thực hiện tìm email hợp lệ:

![image](https://github.com/user-attachments/assets/0f8f7cba-d31f-48fd-85a8-d3152a6b0b15)

- Dùng gobuster tìm những đường dẫn con của nó:

![image](https://github.com/user-attachments/assets/66b65c58-2caf-48c1-b836-34be5eb05c67)

- Thực hiện tải xuống tẹp các danh sách email có sẵn để thực hiện test, sau khi tải xuống ta thực hiện chạy đoạn chương trình trên tìm được 1 email tồn tại:

![image](https://github.com/user-attachments/assets/50d1f5b3-cc68-4afc-a546-6dec8fa28280)

## Exploiting Vulnerable Password Reset Logic

- Ta sử dụng chức năng quên mật khẩu cho email admin@admin.com:

![image](https://github.com/user-attachments/assets/87740fe3-da57-4d52-9bda-0c298accdc66)

- Tiến hành quét các directionary của url `http://10.10.183.37/labs/predictable_tokens/`, ta phát hiện khá nhiều dir nhưng đặc biệt chú ý đến reset_password:

![image](https://github.com/user-attachments/assets/ca3791d9-515e-4032-b0f6-e7ecc8c63772)

- Truy cập đến trang reset_password ta thấy có một thông báo invalid request:

![image](https://github.com/user-attachments/assets/156d99ce-adfb-4354-8c5f-0e6d714e708c)

- Ta thử với tham số token=123 thì đươc thông báo invalid token hãy quan say burpsuite:

![image](https://github.com/user-attachments/assets/0fc4c38a-76f8-4cae-8a18-6d6d6dc9dc3f)

- Chúng ta sẽ brute force token hãy thử với chức năng Intruder của burpsuite:

![image](https://github.com/user-attachments/assets/f93618c9-2fc4-48b5-95b3-6a112b8a46d3)

- Thử đăng nhập vào admin với mật khẩu mới này và chúng ta sẽ có được cờ:

![image](https://github.com/user-attachments/assets/73a62030-5467-4365-a4d1-4898092a6479)
  

## Exploiting HTTP Basic Authentication

- Nhập username và password và quan sat gói tin ở burpsuite:

![image](https://github.com/user-attachments/assets/b19c9e86-aa1e-49cd-9994-2670aa4498be)

- Chú ý Authorization:

![image](https://github.com/user-attachments/assets/4acda207-d947-4061-bc01-da85b29c3dcb)

- Đây là thông tin xác thực được mã hóa base64 của chúng. Giờ chúng ta hãy thử brute force mật khẩu:

![image](https://github.com/user-attachments/assets/b7c42a1d-2778-405e-82a6-7c771f8436de)

- Kết quả là ta brute force thành công:

![image](https://github.com/user-attachments/assets/eb9ccc05-3d88-49b4-8a76-98f7be0bfb34)

![image](https://github.com/user-attachments/assets/c8bf64d7-2297-4a38-9b29-e317e076d11e)

