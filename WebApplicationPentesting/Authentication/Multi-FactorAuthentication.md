# Xác thực đa yếu tố

- Multi-Factor Authentication cung cấp bổ sung thêm khả năng bảo vệ cho tài khoản người dùng bàng cách yêu cầu bạn cung cấp hai hoặc nhiều yếu tố xác minh.

![image](https://github.com/user-attachments/assets/524528a8-2edf-4c12-add3-9969e2628131)

- Something you have: sđt, card ID, ...

- Something you know: password, PIN, ....

- Something you are: dấu vân tay, khuôn mặt, mắt,....

## Các loại 2FA

- Mật khẩu một lần theo thời gian (Time-based One-Time Passwords)

- Push Notifications

- SMS

- Hardware Tokens

## Truy cập có điều kiện

- Location-Based

- Behavioral Analysis

- Device-Specific

- Time-Based

## Common Vulnerabilities in MFA

- Weak OTP Generation Algorithms

- Application Leaking the 2FA Token

- Brute Force OTP

- Usage of Evilginx: Evilginx là một công cụ thường được sử dụng trong các cuộc giao tranh của red team. Được sử dụng để thực hiện các cuộc tấn công lừa đảo tinh vi, bỏ qua hiệu quả Xác thực đa yếu tố ( MFA ). Nó hoạt động như một proxy trung gian có thể chặn và chuyển hướng OTP dành cho người dùng hợp pháp.

![image](https://github.com/user-attachments/assets/573d1ada-c6ce-48b8-b0dd-769736531493)

## OTP Leakage

- Rò rỉ OTP trong phản hồi XHR (XMLHttpRequest) thường xảy ra do triển khai kém cơ chế 2FA (Xác thực hai yếu tố) hoặc mã hóa không an toàn. Một số lý do phổ biến khiến điều này xảy ra là do:

  - Server-Side Validation and Return of Sensitive Data

  - Lack of Proper Security Practices

  - Debugging Information Left in Production

- Challenge:

  ![image](https://github.com/user-attachments/assets/602b8da2-9fa9-45e5-b9aa-498c14edcff0)

  ![image](https://github.com/user-attachments/assets/8b6f87dc-8764-4045-8e91-d83f397e8149)

  ![image](https://github.com/user-attachments/assets/25cf086b-926a-40b9-b45b-c960fcfc024d)


## Insecure Coding

- Trong một số ứng dụng, logic bị lỗi hoặc các hoạt động mã hóa không an toàn có thể dẫn đến tình huống các phần quan trọng của ứng dụng (tức là bảng điều khiển) có thể bị truy cập mà không hoàn tất toàn bộ quy trình xác thực. Cụ thể, kẻ tấn công có thể bỏ qua hoàn toàn cơ chế 2FA và truy cập vào bảng điều khiển hoặc các khu vực nhạy cảm khác mà không cần nhập OTP (Mật khẩu một lần). Điều này thường là do quản lý phiên không đúng cách, kiểm tra kiểm soát truy cập kém hoặc logic được triển khai không đúng cách khiến không thực thi được yêu cầu 2FA.

- Challenge:

  ![image](https://github.com/user-attachments/assets/e382ad72-b300-44c8-9e87-a817213322b7)


## Beating the Auto-Logout Feature

  ![image](https://github.com/user-attachments/assets/63606e56-46b5-4977-90b4-8aaf2ca55014)

  ![image](https://github.com/user-attachments/assets/7c44f80e-aa44-4eee-87b7-6108248e353f)
